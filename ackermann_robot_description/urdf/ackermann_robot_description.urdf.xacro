<?xml version="1.0" encoding="utf-8"?>

<robot xmlns:xacro="http://www.ros.org/wiki/xacro">
    <xacro:macro name="ackermann_robot" params="prefix">
        <link name="${prefix}base_footprint" />
        <link name="${prefix}base_link" />

        <link name="${prefix}chasis_link">
            <visual>
                <geometry>
                    <mesh filename="file://$(find ackermann_robot_description)/meshes/base_link.STL" />
                </geometry>
                <origin xyz="-0.13 0 0" rpy="0 0 0" />
                <material name="yellow" />
            </visual>
            <collision>
                <geometry>
                    <box size="0.28 0.1 0.03" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0" />
            </collision>
        </link>

        <joint name="${prefix}base_link2base_footprint" type="fixed">
            <parent link="${prefix}base_footprint" />
            <child link="${prefix}base_link" />
            <origin xyz="0 0 0.032" rpy="0 0 0" />
        </joint>

        <joint name="${prefix}chasis_link2base_link" type="fixed">
            <parent link="${prefix}base_link" />
            <child link="${prefix}chasis_link" />
            <origin xyz="0.13 0 0.032" rpy="0 0 0" />
        </joint>

        <link name="${prefix}base_inertia">
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="4" />
                <inertia ixx="0.0264" ixy="0" ixz="0" iyy="0.0294" iyz="0" izz="0.00364" />
            </inertial>
        </link>


        <joint name="${prefix}chassis_inertia_joint" type="fixed">
            <origin xyz="0 0 0" rpy="0 0 0" />
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}base_inertia" />
        </joint>


        <link name="${prefix}left_steering_hinge">
            <visual>
                <geometry>
                    <cylinder radius="0.01" length="0.005" />
                </geometry>
                <origin xyz="0 0 0" rpy="1.57 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.01" length="0.005" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="1.57 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="0.5" />
                <inertia ixx="1.35E-05" ixy="0" ixz="0" iyy="1.35E-05" iyz="0" izz="2.5E-05" />
            </inertial>
        </link>


        <joint name="${prefix}left_steering_hinge_joint" type="revolute">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}left_steering_hinge" />
            <origin xyz="0.13 0.065 0" />
            <axis xyz="0 0 1" />
            <limit lower="-0.6" upper="0.6" effort="5.0" velocity="1000.0" />
        </joint>

        <link name="${prefix}left_front_wheel">
            <visual>
                <geometry>
                    <cylinder radius="0.033" length="0.02" />
                </geometry>
                <origin xyz="0 0 0" rpy="1.57 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.032" length="0.02" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="1.57 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="2.0" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}left_front_wheel_joint" type="continuous">
            <parent link="${prefix}left_steering_hinge" />
            <child link="${prefix}left_front_wheel" />
            <origin xyz="0 0.025 0" />
            <axis xyz="0 1 0" />
            <limit effort="10" velocity="1000" />
        </joint>

        <link name="${prefix}right_steering_hinge">
            <visual>
                <geometry>
                    <cylinder radius="0.01" length="0.005" />
                </geometry>
                <origin xyz="0 0 0" rpy="1.57 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.01" length="0.005" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="1.57 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="0.5" />
                <inertia ixx="1.35E-05" ixy="0" ixz="0" iyy="1.35E-05" iyz="0" izz="2.5E-05" />
            </inertial>
        </link>

        <joint name="${prefix}right_steering_hinge_joint" type="revolute">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}right_steering_hinge" />
            <origin xyz="0.13 -0.065 0" />
            <axis xyz="0 0 1" />
            <limit lower="-0.6" upper="0.6" effort="5.0" velocity="1000.0" />
        </joint>

        <link name="${prefix}right_front_wheel">
            <visual>
                <geometry>
                    <cylinder radius="0.033" length="0.02" />
                </geometry>
                <origin xyz="0 0 0" rpy="1.57 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.032" length="0.02" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="1.57 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="2.0" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}right_front_wheel_joint" type="continuous">
            <parent link="${prefix}right_steering_hinge" />
            <child link="${prefix}right_front_wheel" />
            <origin xyz="0 -0.025 0" />
            <axis xyz="0 1 0" />
            <limit effort="10" velocity="1000" />
        </joint>

        <link name="${prefix}left_rear_wheel">
            <visual>
                <geometry>
                    <cylinder radius="0.032" length="0.02" />
                </geometry>
                <origin xyz="0 0 0" rpy="1.57 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.032" length="0.02" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="1.57 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="2.0" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}left_rear_wheel_joint" type="continuous">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}left_rear_wheel" />
            <origin xyz="-0.13 0.09 0" />
            <axis xyz="0 1 0" />
            <limit effort="10" velocity="1000" />
        </joint>

        <link name="${prefix}right_rear_wheel">
            <visual>
                <geometry>
                    <cylinder radius="0.032" length="0.02" />
                </geometry>
                <origin xyz="0 0 0" rpy="1.57 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.032" length="0.02" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="1.57 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="2.0" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}right_rear_wheel_joint" type="continuous">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}right_rear_wheel" />
            <origin xyz="-0.13 -0.09 0" />
            <axis xyz="0 1 0" />
            <limit effort="10" velocity="1000" />
        </joint>

        <link name="${prefix}camera">
            <visual>
                <geometry>
                    <mesh filename="file://$(find ackermann_robot_description)/meshes/camera.STL" />
                </geometry>
                <origin xyz="0 0 -0.025" rpy="0 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <box size="0.005 0.03 0.03" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="0.05" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}camera_joint" type="fixed">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}camera" />
            <origin xyz="0.14851 0.0022137 0.0975" />
            <axis xyz="0 0 1" />
        </joint>


        <link name="${prefix}real_sense">
            <visual>
                <geometry>
                    <mesh filename="file://$(find ackermann_robot_description)/meshes/real_sense.STL" />
                </geometry>
                <origin xyz="0 0 -0.025" rpy="0 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <box size="0.01 0.1 0.02" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="0.05" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}realsense_joint" type="fixed">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}real_sense" />
            <origin xyz="0.18864 0.0038046 0.052021" />
            <axis xyz="0 0 1" />
        </joint>

        <link name="${prefix}realsense_depth" />
        <joint name="${prefix}realsense_depth_joint" type="fixed">
            <origin xyz="0 0 0" rpy="-1.5708 0 -1.5708" />
            <parent link="${prefix}real_sense" />
            <child link="${prefix}realsense_depth" />
        </joint>


        <link name="${prefix}lidar">
            <visual>
                <geometry>
                    <mesh filename="file://$(find ackermann_robot_description)/meshes/laser.STL" />
                </geometry>
                <origin xyz="0 0 -0.025" rpy="0 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <cylinder radius="0.03" length="0.06" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="0.1" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}lidar_joint" type="fixed">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}lidar" />
            <origin xyz="0.093603 0 0.12377" />
            <axis xyz="0 0 1" />
        </joint>

        <link name="${prefix}imu">
            <visual>
                <geometry>
                    <box size="0.01 0.01 0.005" />
                </geometry>
                <origin xyz="0 0 0" rpy="0 0 0" />
                <material name="black" />
            </visual>
            <collision>
                <geometry>
                    <box size="0.01 0.01 0.005" />
                </geometry>
                <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0" />
            </collision>
            <inertial>
                <origin xyz="0 0 0" />
                <mass value="0.05" />
                <inertia ixx="6.64E-04" ixy="0" ixz="0" iyy="6.64E-04" iyz="0" izz="1.02E-03" />
            </inertial>
        </link>

        <joint name="${prefix}imu_joint" type="fixed">
            <parent link="${prefix}chasis_link" />
            <child link="${prefix}imu" />
            <origin xyz="0 0 0.02" />
            <axis xyz="0 0 1" />
        </joint>
    </xacro:macro>
</robot>